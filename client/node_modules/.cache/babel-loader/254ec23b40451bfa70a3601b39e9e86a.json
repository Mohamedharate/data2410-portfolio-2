{"ast":null,"code":"'use strict';\n\nconst OperationBase = require('./operation').OperationBase;\n\nconst handleCallback = require('../utils').handleCallback;\n\nlet collection;\n\nfunction loadCollection() {\n  if (!collection) {\n    collection = require('../collection');\n  }\n\n  return collection;\n}\n\nclass CollectionsOperation extends OperationBase {\n  constructor(db, options) {\n    super(options);\n    this.db = db;\n  }\n\n  execute(callback) {\n    const db = this.db;\n    let options = this.options;\n    let Collection = loadCollection();\n    options = Object.assign({}, options, {\n      nameOnly: true\n    }); // Let's get the collection names\n\n    db.listCollections({}, options).toArray((err, documents) => {\n      if (err != null) return handleCallback(callback, err, null); // Filter collections removing any illegal ones\n\n      documents = documents.filter(doc => {\n        return doc.name.indexOf('$') === -1;\n      }); // Return the collection objects\n\n      handleCallback(callback, null, documents.map(d => {\n        return new Collection(db, db.s.topology, db.databaseName, d.name, db.s.pkFactory, db.s.options);\n      }));\n    });\n  }\n\n}\n\nmodule.exports = CollectionsOperation;","map":{"version":3,"sources":["C:/Users/Tanja Aakerholt/Documents/GitHub/portfolio2/client/node_modules/mongodb/lib/operations/collections.js"],"names":["OperationBase","require","handleCallback","collection","loadCollection","CollectionsOperation","constructor","db","options","execute","callback","Collection","Object","assign","nameOnly","listCollections","toArray","err","documents","filter","doc","name","indexOf","map","d","s","topology","databaseName","pkFactory","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,aAAa,GAAGC,OAAO,CAAC,aAAD,CAAP,CAAuBD,aAA7C;;AACA,MAAME,cAAc,GAAGD,OAAO,CAAC,UAAD,CAAP,CAAoBC,cAA3C;;AAEA,IAAIC,UAAJ;;AACA,SAASC,cAAT,GAA0B;AACxB,MAAI,CAACD,UAAL,EAAiB;AACfA,IAAAA,UAAU,GAAGF,OAAO,CAAC,eAAD,CAApB;AACD;;AACD,SAAOE,UAAP;AACD;;AAED,MAAME,oBAAN,SAAmCL,aAAnC,CAAiD;AAC/CM,EAAAA,WAAW,CAACC,EAAD,EAAKC,OAAL,EAAc;AACvB,UAAMA,OAAN;AAEA,SAAKD,EAAL,GAAUA,EAAV;AACD;;AAEDE,EAAAA,OAAO,CAACC,QAAD,EAAW;AAChB,UAAMH,EAAE,GAAG,KAAKA,EAAhB;AACA,QAAIC,OAAO,GAAG,KAAKA,OAAnB;AAEA,QAAIG,UAAU,GAAGP,cAAc,EAA/B;AAEAI,IAAAA,OAAO,GAAGI,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBL,OAAlB,EAA2B;AAAEM,MAAAA,QAAQ,EAAE;AAAZ,KAA3B,CAAV,CANgB,CAOhB;;AACAP,IAAAA,EAAE,CAACQ,eAAH,CAAmB,EAAnB,EAAuBP,OAAvB,EAAgCQ,OAAhC,CAAwC,CAACC,GAAD,EAAMC,SAAN,KAAoB;AAC1D,UAAID,GAAG,IAAI,IAAX,EAAiB,OAAOf,cAAc,CAACQ,QAAD,EAAWO,GAAX,EAAgB,IAAhB,CAArB,CADyC,CAE1D;;AACAC,MAAAA,SAAS,GAAGA,SAAS,CAACC,MAAV,CAAiBC,GAAG,IAAI;AAClC,eAAOA,GAAG,CAACC,IAAJ,CAASC,OAAT,CAAiB,GAAjB,MAA0B,CAAC,CAAlC;AACD,OAFW,CAAZ,CAH0D,CAO1D;;AACApB,MAAAA,cAAc,CACZQ,QADY,EAEZ,IAFY,EAGZQ,SAAS,CAACK,GAAV,CAAcC,CAAC,IAAI;AACjB,eAAO,IAAIb,UAAJ,CACLJ,EADK,EAELA,EAAE,CAACkB,CAAH,CAAKC,QAFA,EAGLnB,EAAE,CAACoB,YAHE,EAILH,CAAC,CAACH,IAJG,EAKLd,EAAE,CAACkB,CAAH,CAAKG,SALA,EAMLrB,EAAE,CAACkB,CAAH,CAAKjB,OANA,CAAP;AAQD,OATD,CAHY,CAAd;AAcD,KAtBD;AAuBD;;AAtC8C;;AAyCjDqB,MAAM,CAACC,OAAP,GAAiBzB,oBAAjB","sourcesContent":["'use strict';\r\n\r\nconst OperationBase = require('./operation').OperationBase;\r\nconst handleCallback = require('../utils').handleCallback;\r\n\r\nlet collection;\r\nfunction loadCollection() {\r\n  if (!collection) {\r\n    collection = require('../collection');\r\n  }\r\n  return collection;\r\n}\r\n\r\nclass CollectionsOperation extends OperationBase {\r\n  constructor(db, options) {\r\n    super(options);\r\n\r\n    this.db = db;\r\n  }\r\n\r\n  execute(callback) {\r\n    const db = this.db;\r\n    let options = this.options;\r\n\r\n    let Collection = loadCollection();\r\n\r\n    options = Object.assign({}, options, { nameOnly: true });\r\n    // Let's get the collection names\r\n    db.listCollections({}, options).toArray((err, documents) => {\r\n      if (err != null) return handleCallback(callback, err, null);\r\n      // Filter collections removing any illegal ones\r\n      documents = documents.filter(doc => {\r\n        return doc.name.indexOf('$') === -1;\r\n      });\r\n\r\n      // Return the collection objects\r\n      handleCallback(\r\n        callback,\r\n        null,\r\n        documents.map(d => {\r\n          return new Collection(\r\n            db,\r\n            db.s.topology,\r\n            db.databaseName,\r\n            d.name,\r\n            db.s.pkFactory,\r\n            db.s.options\r\n          );\r\n        })\r\n      );\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = CollectionsOperation;\r\n"]},"metadata":{},"sourceType":"script"}