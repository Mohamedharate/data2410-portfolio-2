{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Tanja/IdeaProjects/portfolio2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,useEffect}from\"react\";import axios from\"axios\";import{BrowserRouter as Router,Route,Switch}from'react-router-dom';import Navbar from\"./navbar\";import SignIn from\"./Authentication/SignIn\";import SignUp from\"./Authentication/SignUp\";import About from\"./about\";import Mainpage from\"./Products/mainpage\";import Footer from\"./footer\";import Productpage from\"./Products/productpage\";import addReview from\"./Products/addReview\";import ShoppingCart from\"./ShoppingCart/ShoppingCart\";import Orders from\"./orders\";import CheckOut from\"./CheckOut\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.state={toggleLogin:false,toggleRegister:false,toggleShoppingCart:false,toggleCheckOut:false,isAuthenticated:false,current_user:{},empty_cart:false,empty_cart_message:'Nothing to show here.',cart_objects:[],cart_counter:0,cart_total_price:0,cart_error_feedback:false,cart_success_feedback:false,cart_feedback_text:String};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.Authenticated();case 2:case\"end\":return _context.stop();}}},_callee);}));_this.handleToggleLoginCallback=function(){_this.setState({toggleLogin:!_this.state.toggleLogin,toggleRegister:false,toggleShoppingCart:false,toggleCheckOut:false});};_this.handleToggleRegisterCallback=function(){_this.setState({toggleLogin:false,toggleRegister:!_this.state.toggleRegister,toggleShoppingCart:false,toggleCheckOut:false});};_this.handleToggleShoppingCartCallback=function(){_this.setState({toggleLogin:false,toggleRegister:false,toggleShoppingCart:!_this.state.toggleShoppingCart,toggleCheckOut:false});};_this.handleToggleCheckOutCallback=function(){_this.setState({toggleLogin:false,toggleRegister:false,toggleShoppingCart:false,toggleCheckOut:!_this.state.toggleCheckOut});};_this.handleQuantityIncreaseCallback=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item_id){var cart_objects,index;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:cart_objects=_toConsumableArray(_this.state.cart_objects);index=cart_objects.findIndex(function(i){return i.itemId===item_id;});cart_objects[index].quantity++;_context2.next=5;return axios({method:'post',url:'http://localhost:3001/api/cart/addToCart',data:{product_id:cart_objects[index].itemId,quantity:1}}).then(function(r){_this.updateCartCounterAndPrice(cart_objects);_this.setState({cart_objects:cart_objects});});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handleQuantityDecreaseCallback=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(item_id){var cart_objects,index;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:cart_objects=_toConsumableArray(_this.state.cart_objects);index=cart_objects.findIndex(function(i){return i.itemId===item_id;});if(!(cart_objects[index].quantity>0)){_context3.next=6;break;}cart_objects[index].quantity--;_context3.next=6;return axios({method:'put',url:'http://localhost:3001/api/cart/deleteFromCart',data:{product_id:cart_objects[index].itemId,quantity:1}}).then(function(r){_this.updateCartCounterAndPrice(cart_objects);_this.setState({cart_objects:cart_objects});});case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref3.apply(this,arguments);};}();_this.handleAddToCartCallback=function(product,quantity){console.log(\"add to cart\");var Product=product;Product.quantity=quantity;var cart_objects=[].concat(_toConsumableArray(_this.state.cart_objects),[Product]);_this.updateCartCounterAndPrice(cart_objects);_this.setState({cart_objects:cart_objects,cart_feedback:true});};_this.handleLoginCallback=function(user){var current_user=user;_this.setState({current_user:current_user,isAuthenticated:true});_this.getCartObjects(current_user);_this.setState({toggleLogin:false});};_this.handleLogoutCallback=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios({method:'post',url:'http://localhost:3001/logout',data:{}}).then(function(){sessionStorage.clear();_this.state.toggleShoppingCart=false;var cart_objects=[];_this.updateCartCounterAndPrice(cart_objects);_this.setState({cart_objects:cart_objects,current_user:{},isAuthenticated:false});});case 2:case\"end\":return _context4.stop();}}},_callee4);}));_this.Authenticated=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return axios.get('http://localhost:3001/api/users/isAuthenticated').then(function(response){if(response.status===200){// Session is auth\nvar current_user=response.data;_this.getCartObjects(current_user);_this.setState({current_user:current_user,isAuthenticated:true});}else{// Session is not auth\n_this.setState({current_user:{},isAuthenticated:false});}}).catch(function(error){console.log(error);});case 2:case\"end\":return _context5.stop();}}},_callee5);}));_this.getCartObjects=function(user){if(user.cart.length===0){_this.state.empty_cart=true;_this.state.empty_cart_message='There is nothing to see here!';return true;}else{_this.state.empty_cart=false;var cart_objects=_toConsumableArray(user.cart);_this.updateCartCounterAndPrice(cart_objects);_this.setState({cart_objects:cart_objects});return false;}};_this.updateCartCounterAndPrice=function(cartArray){var cart_counter=0;var cart_total_price=0;cartArray.forEach(function(product){cart_counter+=parseInt(product.quantity);cart_total_price+=parseInt(product.price)*parseInt(product.quantity);});_this.setState({cart_counter:cart_counter,cart_total_price:cart_total_price});};return _this;}_createClass(Home,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{toggleLoginCallback:this.handleToggleLoginCallback,toggleRegisterCallback:this.handleToggleRegisterCallback,toggleShoppingCartCallback:this.handleToggleShoppingCartCallback,handleLogoutCallback:this.handleLogoutCallback,isAuthenticated:this.state.isAuthenticated,current_user:this.state.current_user,cart_counter:this.state.cart_counter,cart_total_price:this.state.cart_total_price}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:Mainpage}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/products/:itemId\",component:function component(){return/*#__PURE__*/_jsx(Productpage,{itemId:window.location.href.split('/').pop(),handleAddToCartCallback:_this2.handleAddToCartCallback});}}),/*#__PURE__*/_jsx(Route,{path:\"/addReview/:itemId\",component:addReview}),/*#__PURE__*/_jsx(Route,{path:\"/orders/\",component:function component(){return/*#__PURE__*/_jsx(Orders,{current_user:_this2.state.current_user,isAuthenticated:_this2.state.isAuthenticated});}})]}),this.state.toggleLogin&&/*#__PURE__*/_jsx(SignIn,{loginCallback:this.handleLoginCallback,close:this.handleToggleLoginCallback}),this.state.toggleRegister&&/*#__PURE__*/_jsx(SignUp,{close:this.handleToggleRegisterCallback}),this.state.toggleCheckOut&&/*#__PURE__*/_jsx(CheckOut,{cart_objects:this.state.cart_objects,current_user:this.state.current_user,price_total:this.state.cart_total_price,signed_in:this.state.isAuthenticated,order_complete:this.getCartObjects,close:this.handleToggleCheckOutCallback}),this.state.toggleShoppingCart&&/*#__PURE__*/_jsx(ShoppingCart,{handleAddToCartCallback:this.handleAddToCartCallback,quantity_increase:this.handleQuantityIncreaseCallback,quantity_decrease:this.handleQuantityDecreaseCallback,onCheckOut:this.handleToggleCheckOutCallback,empty_cart:this.state.empty_cart,empty_cart_message:this.state.empty_cart_message,cart_objects:this.state.cart_objects,cart_total_price:this.state.cart_total_price,toggle_error_feedback:this.state.cart_error_feedback,toggle_success_feedback:this.state.cart_success_feedback,feedback_text:this.state.cart_feedback_text}),/*#__PURE__*/_jsx(About,{}),/*#__PURE__*/_jsx(Footer,{toggle_admin:this.props.toggle_admin})]})});}}]);return Home;}(Component);export default Home;","map":{"version":3,"sources":["C:/Users/Tanja/IdeaProjects/portfolio2/client/src/Components/home.jsx"],"names":["React","Component","useEffect","axios","BrowserRouter","Router","Route","Switch","Navbar","SignIn","SignUp","About","Mainpage","Footer","Productpage","addReview","ShoppingCart","Orders","CheckOut","Home","props","state","toggleLogin","toggleRegister","toggleShoppingCart","toggleCheckOut","isAuthenticated","current_user","empty_cart","empty_cart_message","cart_objects","cart_counter","cart_total_price","cart_error_feedback","cart_success_feedback","cart_feedback_text","String","componentDidMount","Authenticated","handleToggleLoginCallback","setState","handleToggleRegisterCallback","handleToggleShoppingCartCallback","handleToggleCheckOutCallback","handleQuantityIncreaseCallback","item_id","index","findIndex","i","itemId","quantity","method","url","data","product_id","then","r","updateCartCounterAndPrice","handleQuantityDecreaseCallback","handleAddToCartCallback","product","console","log","Product","cart_feedback","handleLoginCallback","user","getCartObjects","handleLogoutCallback","sessionStorage","clear","get","response","status","catch","error","cart","length","cartArray","forEach","parseInt","price","window","location","href","split","pop","toggle_admin"],"mappings":"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","sourcesContent":["import React, {Component, useEffect} from \"react\";\r\nimport axios from \"axios\";\r\nimport {BrowserRouter as Router, Route, Switch} from 'react-router-dom';\r\nimport Navbar from \"./navbar\";\r\nimport SignIn from \"./Authentication/SignIn\";\r\nimport SignUp from \"./Authentication/SignUp\";\r\nimport About from \"./about\";\r\nimport Mainpage from \"./Products/mainpage\";\r\nimport Footer from \"./footer\";\r\nimport Productpage from \"./Products/productpage\";\r\nimport addReview from \"./Products/addReview\";\r\nimport ShoppingCart from \"./ShoppingCart/ShoppingCart\";\r\nimport Orders from \"./orders\";\r\nimport CheckOut from \"./CheckOut\";\r\n\r\n\r\nclass Home extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n    state = {\r\n        toggleLogin: false,\r\n        toggleRegister: false,\r\n        toggleShoppingCart: false,\r\n        toggleCheckOut: false,\r\n        isAuthenticated: false,\r\n        current_user: {},\r\n        empty_cart: false,\r\n        empty_cart_message: 'Nothing to show here.',\r\n        cart_objects: [],\r\n        cart_counter: 0,\r\n        cart_total_price: 0,\r\n        cart_error_feedback: false,\r\n        cart_success_feedback: false,\r\n        cart_feedback_text: String,\r\n    };\r\n\r\n    componentDidMount = async () => {\r\n        await this.Authenticated()\r\n    };\r\n\r\n    // Handlers\r\n    // Toggle windows.\r\n    handleToggleLoginCallback = () => {\r\n        this.setState({\r\n            toggleLogin: !this.state.toggleLogin,\r\n            toggleRegister: false,\r\n            toggleShoppingCart: false,\r\n            toggleCheckOut: false,\r\n        });\r\n    }\r\n    handleToggleRegisterCallback = () => {\r\n        this.setState({\r\n            toggleLogin: false,\r\n            toggleRegister: !this.state.toggleRegister,\r\n            toggleShoppingCart: false,\r\n            toggleCheckOut: false,\r\n        });\r\n    }\r\n    handleToggleShoppingCartCallback = () => {\r\n        this.setState({\r\n            toggleLogin: false,\r\n            toggleRegister: false,\r\n            toggleShoppingCart: !this.state.toggleShoppingCart,\r\n            toggleCheckOut: false,\r\n        });\r\n    }\r\n    handleToggleCheckOutCallback = () => {\r\n        this.setState({\r\n            toggleLogin: false,\r\n            toggleRegister: false,\r\n            toggleShoppingCart: false,\r\n            toggleCheckOut: !this.state.toggleCheckOut,\r\n        })\r\n    }\r\n\r\n    // Handle cart\r\n    handleQuantityIncreaseCallback = async item_id => {\r\n        const cart_objects = [...this.state.cart_objects];\r\n        const index = cart_objects.findIndex(i => i.itemId === item_id)\r\n        cart_objects[index].quantity++;\r\n        await axios({\r\n            method: 'post',\r\n            url: 'http://localhost:3001/api/cart/addToCart',\r\n            data: {\r\n                product_id: cart_objects[index].itemId,\r\n                quantity: 1\r\n            },\r\n        }).then(r => {\r\n            this.updateCartCounterAndPrice(cart_objects);\r\n            this.setState({cart_objects})\r\n        })\r\n    }\r\n    handleQuantityDecreaseCallback = async item_id => {\r\n        const cart_objects = [...this.state.cart_objects];\r\n        const index = cart_objects.findIndex(i => i.itemId === item_id)\r\n        if (cart_objects[index].quantity > 0){\r\n            cart_objects[index].quantity--;\r\n            await axios({\r\n                method: 'put',\r\n                url: 'http://localhost:3001/api/cart/deleteFromCart',\r\n                data: {\r\n                    product_id: cart_objects[index].itemId,\r\n                    quantity: 1\r\n                },\r\n            }).then(r => {\r\n                this.updateCartCounterAndPrice(cart_objects);\r\n                this.setState({cart_objects});\r\n            })\r\n        }\r\n    }\r\n    handleAddToCartCallback = (product, quantity) => {\r\n        console.log(\"add to cart\")\r\n        const Product = product;\r\n        Product.quantity = quantity;\r\n\r\n        const cart_objects = [...this.state.cart_objects, Product];\r\n        this.updateCartCounterAndPrice(cart_objects);\r\n        this.setState({cart_objects, cart_feedback: true})\r\n    }\r\n\r\n\r\n\r\n    // Handle authentication.\r\n    handleLoginCallback = user => {\r\n        const current_user = user;\r\n        this.setState({current_user, isAuthenticated: true});\r\n        this.getCartObjects(current_user);\r\n        this.setState({toggleLogin: false});\r\n    };\r\n    handleLogoutCallback = async () => {\r\n        await axios({\r\n            method: 'post',\r\n            url: 'http://localhost:3001/logout',\r\n            data: {}\r\n        }).then(() => {\r\n            sessionStorage.clear();\r\n            this.state.toggleShoppingCart = false;\r\n            const cart_objects = [];\r\n            this.updateCartCounterAndPrice(cart_objects);\r\n            this.setState({\r\n                cart_objects,\r\n                current_user: {},\r\n                isAuthenticated: false\r\n            });\r\n        })\r\n    };\r\n    Authenticated = async () => {\r\n        await axios.get('http://localhost:3001/api/users/isAuthenticated')\r\n            .then(response => {\r\n                if (response.status === 200) {\r\n                    // Session is auth\r\n                    const current_user = response.data;\r\n                    this.getCartObjects(current_user);\r\n                    this.setState({ current_user, isAuthenticated: true});\r\n                } else {\r\n                    // Session is not auth\r\n                    this.setState({ current_user: {}, isAuthenticated: false });\r\n                }\r\n            }).catch(error => {\r\n                console.log(error);\r\n            });\r\n    };\r\n\r\n    // Cart\r\n    // Instantiate Cart\r\n    getCartObjects = user => {\r\n        if (user.cart.length === 0) {\r\n            this.state.empty_cart = true;\r\n            this.state.empty_cart_message = 'There is nothing to see here!';\r\n            return true;\r\n        } else {\r\n            this.state.empty_cart = false;\r\n            const cart_objects = [...user.cart];\r\n            this.updateCartCounterAndPrice(cart_objects);\r\n            this.setState({cart_objects});\r\n            return false;\r\n        }\r\n    };\r\n    // Updating cart values for the navbar.\r\n    updateCartCounterAndPrice = cartArray => {\r\n        let cart_counter = 0;\r\n        let cart_total_price = 0;\r\n        cartArray.forEach(product => {\r\n            cart_counter += parseInt(product.quantity);\r\n            cart_total_price += parseInt(product.price) * parseInt(product.quantity)\r\n        });\r\n        this.setState({cart_counter, cart_total_price})\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Router>\r\n                <React.Fragment>\r\n                    <Navbar\r\n                        toggleLoginCallback={this.handleToggleLoginCallback}\r\n                        toggleRegisterCallback={this.handleToggleRegisterCallback}\r\n                        toggleShoppingCartCallback={this.handleToggleShoppingCartCallback}\r\n                        handleLogoutCallback={this.handleLogoutCallback}\r\n                        isAuthenticated={this.state.isAuthenticated}\r\n                        current_user={this.state.current_user}\r\n                        cart_counter={this.state.cart_counter}\r\n                        cart_total_price={this.state.cart_total_price}\r\n                    />\r\n                    <Switch>\r\n                        <Route exact path=\"/\" component={Mainpage}/>\r\n                        <Route exact path=\"/products/:itemId\" component={() =>\r\n                            <Productpage itemId={window.location.href.split('/').pop()}\r\n                                         handleAddToCartCallback={this.handleAddToCartCallback} /> }/>\r\n                        <Route path=\"/addReview/:itemId\" component={addReview}/>\r\n                        <Route path=\"/orders/\" component={() =>\r\n                            <Orders current_user={this.state.current_user} isAuthenticated={this.state.isAuthenticated}/>}/>\r\n                    </Switch>\r\n                    {this.state.toggleLogin && <SignIn\r\n                        loginCallback={this.handleLoginCallback}\r\n                        close={this.handleToggleLoginCallback}\r\n                    />}\r\n                    {this.state.toggleRegister && <SignUp\r\n                        close={this.handleToggleRegisterCallback}\r\n                    />}\r\n                    {this.state.toggleCheckOut && <CheckOut\r\n                        cart_objects={this.state.cart_objects}\r\n                        current_user={this.state.current_user}\r\n                        price_total={this.state.cart_total_price}\r\n                        signed_in={this.state.isAuthenticated}\r\n                        order_complete={this.getCartObjects}\r\n                        close={this.handleToggleCheckOutCallback}\r\n                    />}\r\n                    {this.state.toggleShoppingCart &&\r\n                    <ShoppingCart\r\n                        handleAddToCartCallback={this.handleAddToCartCallback}\r\n                        quantity_increase={this.handleQuantityIncreaseCallback}\r\n                        quantity_decrease={this.handleQuantityDecreaseCallback}\r\n                        onCheckOut={this.handleToggleCheckOutCallback}\r\n                        empty_cart={this.state.empty_cart}\r\n                        empty_cart_message={this.state.empty_cart_message}\r\n                        cart_objects={this.state.cart_objects}\r\n                        cart_total_price={this.state.cart_total_price}\r\n                        toggle_error_feedback={this.state.cart_error_feedback}\r\n                        toggle_success_feedback={this.state.cart_success_feedback}\r\n                        feedback_text={this.state.cart_feedback_text}\r\n                    />\r\n                    }\r\n                    <About/>\r\n                    <Footer toggle_admin={this.props.toggle_admin}/>\r\n                </React.Fragment>\r\n            </Router>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}