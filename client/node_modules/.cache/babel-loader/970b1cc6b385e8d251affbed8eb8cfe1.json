{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import DangerFeedback from\"../dangerFeedback\";import SuccessFeedback from\"../successFeedback\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AdminEditProduct=/*#__PURE__*/function(_Component){_inherits(AdminEditProduct,_Component);var _super=_createSuper(AdminEditProduct);function AdminEditProduct(props){var _this;_classCallCheck(this,AdminEditProduct);_this=_super.call(this,props);_this.state={products:[],imagePreview:'',itemId:Number,old_imageArray:[],old_product_name:String,old_product_price:Number,old_product_stock:Number,old_product_category:String,old_short_description:String,old_long_description:String,new_imageArray:[],new_product_name:String,new_product_price:Number,new_product_stock:Number,new_product_category:String,new_short_description:String,new_long_description:String,feedback_text:String,toggle_error_feedback:false,toggle_success_feedback:false};_this.handleGetProducts=function(){_this.getProducts().then();};_this.handleInputChange=function(event){var target=event.target;var value=target.value;var name=target.name;_this.setState(_defineProperty({},'new_'+name,value));};_this.handleInputFile=function(event){var file=event.target.files[0];//TODO make this work for a list of pictures.\n_this.setState({imagePreview:URL.createObjectURL(file)});var new_imageArray=file;_this.setState({new_imageArray:new_imageArray});};_this.handleEditBtn=function(product){var preview=\"data:\".concat(product.imageUrl[0].contentType,\";base64, \").concat(product.imageUrl[0].image);_this.setState({imagePreview:preview,itemId:product.itemId,old_imageArray:product.imageUrl,old_product_name:product.name,old_product_price:parseInt(product.price.$numberDecimal),old_product_stock:product.quantity,old_product_category:product.category,old_short_description:product.descriptionShort,old_long_description:product.descriptionLong,new_imageArray:product.imageUrl,new_product_name:product.name,new_product_price:parseInt(product.price.$numberDecimal),new_product_stock:product.quantity,new_product_category:product.category,new_short_description:product.descriptionShort,new_long_description:product.descriptionLong});};_this.handleSubmit=function(event){event.preventDefault();var file=_this.state.new_imageArray;console.log(\"submit new file\",file);//TODO console\nconsole.log(\"submit old file\",_this.state.old_imageArray);//TODO console\nvar formdata=new FormData();// Checks which variables has changed and add changed variables to the form-data.\nif(_this.state.old_imageArray!==_this.state.new_imageArray){console.log(\"Bildet er endret!\");formdata.append('imageUrl',file);}if(_this.state.old_product_name!==_this.state.new_product_name){console.log(\"endret!\");formdata.append('name',_this.state.new_product_name);}if(_this.state.old_short_description!==_this.state.new_short_description){console.log(\"endret!\");formdata.append('descriptionShort',_this.state.new_short_description);}if(_this.state.old_long_description!==_this.state.new_long_description){console.log(\"endret!\");formdata.append('descriptionLong',_this.state.new_long_description);}if(_this.state.old_product_price!==_this.state.new_product_price){console.log(\"endret!\");formdata.append('price',_this.state.new_product_price);}if(_this.state.old_product_category!==_this.state.new_product_category){console.log(\"endret!\");formdata.append('category',_this.state.new_product_category);}if(_this.state.old_product_stock!==_this.state.new_product_stock){console.log(\"endret!\");formdata.append('quantity',_this.state.new_product_stock);}console.log(formdata);//TODO console\n_this.updateProduct(formdata).then();};_this.handleInputChange=_this.handleInputChange.bind(_assertThisInitialized(_this));_this.handleInputFile=_this.handleInputFile.bind(_assertThisInitialized(_this));return _this;}_createClass(AdminEditProduct,[{key:\"updateProduct\",value:function(){var _updateProduct=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formdata){var _this2=this;var itemId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:itemId=this.state.itemId;console.log(\"updating\");_context.next=4;return axios({method:'put',url:\"http://localhost:3001/api/products/update/\".concat(itemId),data:formdata}).then(function(res){_this2.setState({toggle_success_feedback:true,toggle_error_feedback:false,feedback_text:res.data.Message});}).catch(function(err){_this2.setState({toggle_success_feedback:false,toggle_error_feedback:true,feedback_text:err.response.data.Error});});case 4:case\"end\":return _context.stop();}}},_callee,this);}));function updateProduct(_x){return _updateProduct.apply(this,arguments);}return updateProduct;}()},{key:\"getProducts\",value:function(){var _getProducts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this3=this;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('http://localhost:3001/api/products/get/allProductsPure').then(function(res){var products=res.data;_this3.setState({products:products});}).then(function(res){_this3.setState({toggle_success_feedback:true,toggle_error_feedback:false,feedback_text:res.data.Message});}).catch(function(err){_this3.setState({toggle_success_feedback:false,toggle_error_feedback:true,feedback_text:err.response.data.Error});});case 2:case\"end\":return _context2.stop();}}},_callee2);}));function getProducts(){return _getProducts.apply(this,arguments);}return getProducts;}()},{key:\"render\",value:function render(){var _this4=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"fillPage\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row text-center mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Edit Products\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:this.handleGetProducts,className:\"btn btn-primary\",children:\"Get Products\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row text-center mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-4 float-left one\",children:this.state.products.map(function(product,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mt-2 ml-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:product.name,disabled:true}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(\"div\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this4.handleEditBtn(product);},className:\"btn\",children:\"Edit\"})})})]},index);})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8 text-left position-fixed offset-sm-3 mr-2 two\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,className:\"form-addProduct\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row form-label-group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-6 m-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"uploadImage\",children:\"Upload Image:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",id:\"uploadImg\",children:\"Upload Image\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-file\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:this.handleInputFile,type:\"file\",className:\"form-control-file\",id:\"uploadImage\",name:\"imageUrl\",\"aria-describedby\":\"uploadImg\",multiple:true}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-file-label\",htmlFor:\"uploadImage\",children:\"Choose file..\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-sm-5\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Preview image:\"}),/*#__PURE__*/_jsx(\"img\",{className:\"previewImage\",src:this.state.imagePreview,alt:\"\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row form-label-group m-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-sm-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"mt-2\",htmlFor:\"product_name\",children:\"Product name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Name\",name:\"product_name\",value:this.state.new_product_name,required:true,autoFocus:\"\"}),/*#__PURE__*/_jsx(\"label\",{className:\"mt-2\",htmlFor:\"product_price\",children:\"Product price:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-prepend\",children:/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",children:\"$\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Price\",name:\"product_price\",value:this.state.new_product_price,required:true})]}),/*#__PURE__*/_jsx(\"label\",{className:\"mt-2\",htmlFor:\"product_stock\",children:\"Product Stock:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Stock\",name:\"product_stock\",value:this.state.new_product_stock,required:true,autoFocus:\"\"}),/*#__PURE__*/_jsx(\"label\",{className:\"mt-2\",htmlFor:\"product_category\",children:\"Category\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"product_category\",onChange:this.handleInputChange,className:\"custom-select my-1 mr-sm-2\",value:this.state.new_product_category,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",defaultValue:\"\",children:\"Choose...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Coffee Capsules\",children:\"Coffee Capsules\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Coffee Beans\",children:\"Coffee Beans\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Filter Ground Coffee\",children:\"Filter Ground Coffee\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Coffee Machine\",children:\"Coffee Machine\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Coffee\",children:\"Coffee\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-sm-5\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"mt-2\",htmlFor:\"short_description\",children:\"Short Description:\"}),/*#__PURE__*/_jsx(\"textarea\",{onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Short Description\",value:this.state.new_short_description,rows:\"3\",name:\"short_description\",required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"mt-2\",htmlFor:\"long_description\",children:\"Long Description:\"}),/*#__PURE__*/_jsx(\"textarea\",{onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Long Description\",value:this.state.new_long_description,rows:\"6\",name:\"long_description\",required:true})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row m-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-3\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-lg btn-primary btn-block mt-2\",children:\"Update Product\"})})}),this.state.toggle_error_feedback&&/*#__PURE__*/_jsx(DangerFeedback,{feedback_error_text:this.state.feedback_text}),this.state.toggle_success_feedback&&/*#__PURE__*/_jsx(SuccessFeedback,{feedback_success_text:this.state.feedback_text})]})})]})]});}}]);return AdminEditProduct;}(Component);export default AdminEditProduct;","map":{"version":3,"sources":["C:/Users/Havnaas/Documents/Intellj/data2410-portfolio-2/client/src/Components/Admin/AdminEditProduct.jsx"],"names":["React","Component","axios","DangerFeedback","SuccessFeedback","AdminEditProduct","props","state","products","imagePreview","itemId","Number","old_imageArray","old_product_name","String","old_product_price","old_product_stock","old_product_category","old_short_description","old_long_description","new_imageArray","new_product_name","new_product_price","new_product_stock","new_product_category","new_short_description","new_long_description","feedback_text","toggle_error_feedback","toggle_success_feedback","handleGetProducts","getProducts","then","handleInputChange","event","target","value","name","setState","handleInputFile","file","files","URL","createObjectURL","handleEditBtn","product","preview","imageUrl","contentType","image","parseInt","price","$numberDecimal","quantity","category","descriptionShort","descriptionLong","handleSubmit","preventDefault","console","log","formdata","FormData","append","updateProduct","bind","method","url","data","res","Message","catch","err","response","Error","get","map","index"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport axios from \"axios\";\r\nimport DangerFeedback from \"../dangerFeedback\";\r\nimport SuccessFeedback from \"../successFeedback\";\r\n\r\nclass AdminEditProduct extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.handleInputChange = this.handleInputChange.bind(this)\r\n        this.handleInputFile = this.handleInputFile.bind(this)\r\n    }\r\n\r\n    state = {\r\n        products: [],\r\n        imagePreview: '',\r\n        itemId: Number,\r\n\r\n        old_imageArray: [],\r\n        old_product_name: String,\r\n        old_product_price: Number,\r\n        old_product_stock: Number,\r\n        old_product_category: String,\r\n        old_short_description: String,\r\n        old_long_description: String,\r\n\r\n        new_imageArray: [],\r\n        new_product_name: String,\r\n        new_product_price: Number,\r\n        new_product_stock: Number,\r\n        new_product_category: String,\r\n        new_short_description: String,\r\n        new_long_description: String,\r\n\r\n        feedback_text: String,\r\n        toggle_error_feedback: false,\r\n        toggle_success_feedback: false,\r\n    };\r\n\r\n    handleGetProducts = () => {\r\n        this.getProducts().then()\r\n    };\r\n    handleInputChange = event => {\r\n        const target = event.target;\r\n        const value = target.value;\r\n        const name = target.name;\r\n\r\n        this.setState({\r\n            ['new_'+name]: value\r\n        })\r\n    };\r\n    handleInputFile = event => {\r\n        const file = event.target.files[0]; //TODO make this work for a list of pictures.\r\n\r\n        this.setState({imagePreview: URL.createObjectURL(file)})\r\n\r\n        const new_imageArray = file\r\n        this.setState({new_imageArray});\r\n    }\r\n    handleEditBtn = product => {\r\n\r\n        const preview = `data:${product.imageUrl[0].contentType};base64, ${product.imageUrl[0].image}`\r\n\r\n        this.setState({\r\n            imagePreview: preview,\r\n            itemId: product.itemId,\r\n\r\n            old_imageArray: product.imageUrl,\r\n            old_product_name: product.name,\r\n            old_product_price: parseInt(product.price.$numberDecimal),\r\n            old_product_stock: product.quantity,\r\n            old_product_category: product.category,\r\n            old_short_description: product.descriptionShort,\r\n            old_long_description: product.descriptionLong,\r\n\r\n            new_imageArray: product.imageUrl,\r\n            new_product_name: product.name,\r\n            new_product_price: parseInt(product.price.$numberDecimal),\r\n            new_product_stock: product.quantity,\r\n            new_product_category: product.category,\r\n            new_short_description: product.descriptionShort,\r\n            new_long_description: product.descriptionLong,\r\n\r\n        })\r\n\r\n    }\r\n    handleSubmit = event => {\r\n        event.preventDefault();\r\n\r\n        let file = this.state.new_imageArray;\r\n\r\n        console.log(\"submit new file\", file) //TODO console\r\n        console.log(\"submit old file\", this.state.old_imageArray) //TODO console\r\n        let formdata = new FormData();\r\n\r\n        // Checks which variables has changed and add changed variables to the form-data.\r\n        if (this.state.old_imageArray !== this.state.new_imageArray) {\r\n            console.log(\"Bildet er endret!\")\r\n            formdata.append('imageUrl', file);\r\n        }\r\n        if (this.state.old_product_name !== this.state.new_product_name) {\r\n            console.log(\"endret!\")\r\n            formdata.append('name', this.state.new_product_name);\r\n        }\r\n        if (this.state.old_short_description !== this.state.new_short_description) {\r\n            console.log(\"endret!\")\r\n            formdata.append('descriptionShort', this.state.new_short_description);\r\n        }\r\n        if (this.state.old_long_description !== this.state.new_long_description) {\r\n            console.log(\"endret!\")\r\n            formdata.append('descriptionLong', this.state.new_long_description);\r\n        }\r\n        if (this.state.old_product_price !== this.state.new_product_price) {\r\n            console.log(\"endret!\")\r\n            formdata.append('price', this.state.new_product_price);\r\n        }\r\n        if (this.state.old_product_category !== this.state.new_product_category) {\r\n            console.log(\"endret!\")\r\n            formdata.append('category', this.state.new_product_category);\r\n        }\r\n        if (this.state.old_product_stock !== this.state.new_product_stock) {\r\n            console.log(\"endret!\")\r\n            formdata.append('quantity', this.state.new_product_stock);\r\n        }\r\n\r\n        console.log(formdata); //TODO console\r\n\r\n        this.updateProduct(formdata).then();\r\n    };\r\n\r\n    async updateProduct(formdata) {\r\n        const itemId = this.state.itemId;\r\n        console.log(\"updating\")\r\n        await axios({\r\n            method: 'put',\r\n            url: `http://localhost:3001/api/products/update/${itemId}`,\r\n            data: formdata,\r\n        }).then(res => {\r\n            this.setState({\r\n                toggle_success_feedback: true,\r\n                toggle_error_feedback: false,\r\n                feedback_text: res.data.Message,\r\n            })\r\n        }).catch(err => {\r\n            this.setState({\r\n                toggle_success_feedback: false,\r\n                toggle_error_feedback: true,\r\n                feedback_text: err.response.data.Error,\r\n            })\r\n        })\r\n    }\r\n\r\n    async getProducts() {\r\n        await axios.get('http://localhost:3001/api/products/get/allProductsPure')\r\n            .then(res => {\r\n                const products = res.data\r\n                this.setState({products})\r\n            }).then(res => {\r\n                this.setState({\r\n                    toggle_success_feedback: true,\r\n                    toggle_error_feedback: false,\r\n                    feedback_text: res.data.Message,\r\n                })\r\n            }).catch(err => {\r\n                this.setState({\r\n                    toggle_success_feedback: false,\r\n                    toggle_error_feedback: true,\r\n                    feedback_text: err.response.data.Error,\r\n                })\r\n            })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"fillPage\">\r\n                <div className=\"row text-center mt-5\">\r\n                    <div className=\"col-md-4\"/>\r\n                    <div className=\"col-md-4\">\r\n                        <h3>Edit Products</h3>\r\n                    </div>\r\n                    <div className=\"col-md-4\">\r\n                        <button onClick={this.handleGetProducts} className=\"btn btn-primary\">\r\n                            Get Products\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div className=\"row text-center mt-5\">\r\n                    <div className=\"col-sm-4 float-left one\">\r\n                        {this.state.products.map((product, index) => (\r\n                            <div className=\"input-group mt-2 ml-2\" key={index}>\r\n                                <input type=\"text\" value={product.name} disabled/>\r\n                                <div className=\"input-group-append\">\r\n                                    <div className=\"input-group-text\">\r\n                                        <button onClick={() => this.handleEditBtn(product)} className=\"btn\">Edit</button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"col-sm-8 text-left position-fixed offset-sm-3 mr-2 two\">\r\n                        <form onSubmit={this.handleSubmit} className=\"form-addProduct\">\r\n                            <div className=\"row form-label-group\">\r\n                                <div className=\"col-6 m-4\">\r\n                                    <label htmlFor=\"uploadImage\">Upload Image:</label>\r\n                                    <div className=\"input-group\">\r\n                                        <div className=\"input-group-prepend\">\r\n                                            <span className=\"input-group-text\" id=\"uploadImg\">Upload Image</span>\r\n                                        </div>\r\n                                        <div className=\"custom-file\">\r\n                                            <input onChange={this.handleInputFile} type=\"file\"\r\n                                                   className=\"form-control-file\"\r\n                                                   id=\"uploadImage\"\r\n                                                   name=\"imageUrl\" aria-describedby=\"uploadImg\" multiple/>\r\n                                            <label className=\"custom-file-label\"\r\n                                                   htmlFor=\"uploadImage\">Choose file..</label>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"col-sm-5\">\r\n                                    <p>Preview image:</p>\r\n                                    <img className=\"previewImage\" src={this.state.imagePreview} alt=\"\"/>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"row form-label-group m-2\">\r\n                                <div className=\"col-sm-6\">\r\n                                    <label className=\"mt-2\" htmlFor=\"product_name\">Product name:</label>\r\n                                    <input type=\"text\" onChange={this.handleInputChange}\r\n                                           className=\"form-control\" placeholder=\"Name\"\r\n                                           name=\"product_name\" value={this.state.new_product_name} required\r\n                                           autoFocus=\"\"/>\r\n                                    <label className=\"mt-2\" htmlFor=\"product_price\">Product price:</label>\r\n                                    <div className=\"input-group\">\r\n                                        <div className=\"input-group-prepend\">\r\n                                            <span className=\"input-group-text\">$</span>\r\n                                        </div>\r\n                                        <input type=\"number\" onChange={this.handleInputChange}\r\n                                               className=\"form-control\" placeholder=\"Price\"\r\n                                               name=\"product_price\" value={this.state.new_product_price} required/>\r\n                                    </div>\r\n                                    <label className=\"mt-2\" htmlFor=\"product_stock\">Product Stock:</label>\r\n                                    <input type=\"number\" onChange={this.handleInputChange}\r\n                                           className=\"form-control\" placeholder=\"Stock\"\r\n                                           name=\"product_stock\" value={this.state.new_product_stock} required\r\n                                           autoFocus=\"\"/>\r\n                                    <label className=\"mt-2\" htmlFor=\"product_category\">Category</label>\r\n                                    <select name=\"product_category\" onChange={this.handleInputChange}\r\n                                            className=\"custom-select my-1 mr-sm-2\"\r\n                                            value={this.state.new_product_category} required>\r\n                                        <option value=\"\" defaultValue=\"\">Choose...</option>\r\n                                        <option value=\"Coffee Capsules\">Coffee Capsules</option>\r\n                                        <option value=\"Coffee Beans\">Coffee Beans</option>\r\n                                        <option value=\"Filter Ground Coffee\">Filter Ground Coffee</option>\r\n                                        <option value=\"Coffee Machine\">Coffee Machine</option>\r\n                                        <option value=\"Coffee\">Coffee</option>\r\n                                        <option value=\"Other\">Other</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div className=\"col-sm-5\">\r\n                                    <label className=\"mt-2\" htmlFor=\"short_description\">Short Description:</label>\r\n                                    <textarea onChange={this.handleInputChange} className=\"form-control\"\r\n                                              placeholder=\"Short Description\" value={this.state.new_short_description}\r\n                                              rows=\"3\" name=\"short_description\" required/>\r\n                                    <label className=\"mt-2\" htmlFor=\"long_description\">Long Description:</label>\r\n                                    <textarea onChange={this.handleInputChange} className=\"form-control\"\r\n                                              placeholder=\"Long Description\" value={this.state.new_long_description}\r\n                                              rows=\"6\" name=\"long_description\" required/>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"row m-2\">\r\n                                <div className=\"col-md-3\">\r\n                                    <button type=\"submit\" className=\"btn btn-lg btn-primary btn-block mt-2\">\r\n                                        Update Product\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            {this.state.toggle_error_feedback &&\r\n                            <DangerFeedback feedback_error_text={this.state.feedback_text}/>}\r\n                            {this.state.toggle_success_feedback &&\r\n                            <SuccessFeedback feedback_success_text={this.state.feedback_text}/>}\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AdminEditProduct;"]},"metadata":{},"sourceType":"module"}