{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import Navbar from\"./navbar\";import Login from\"./login\";import Register from\"./register\";import Bestsellers from\"./bestsellers\";import Mainpage from\"./mainpage\";import Footer from\"./footer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.handleToggleLoginCallback=function(){_this.setState({toggleLogin:!_this.props.toggleLogin,toggleRegister:false});};_this.handleToggleRegisterCallback=function(){_this.setState({toggleLogin:false,toggleRegister:!_this.props.toggleRegister});};_this.handleLogin=function(){_this.tryIsAuthenticated().then();};_this.handleLogoutCallback=function(){console.log(\"HandleLogout i home\");_this.tryLogout().then();};_this.props={toggleLogin:false,toggleRegister:false,isAuthenticated:false,current_user:{}};_this.handleLoad=_this.handleLoad.bind(_assertThisInitialized(_this));return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){window.addEventListener('load',this.handleLoad);}},{key:\"handleLoad\",value:function(){var _handleLoad=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.tryIsAuthenticated().then();case 1:case\"end\":return _context.stop();}}},_callee,this);}));function handleLoad(){return _handleLoad.apply(this,arguments);}return handleLoad;}()},{key:\"tryIsAuthenticated\",value:function(){var _tryIsAuthenticated=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this2=this;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('http://localhost:3001/api/users/isAuthenticated').then(function(response){_this2.setState({isAuthenticated:true});_this2.setState({current_user:response.data});_this2.setState({toggleLogin:false});console.log(_this2.props.current_user.firstName);}).catch(function(error){_this2.setState({isAuthenticated:false});_this2.setState({current_user:{}});console.log(\"No session available: \",error.data);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));function tryIsAuthenticated(){return _tryIsAuthenticated.apply(this,arguments);}return tryIsAuthenticated;}()},{key:\"tryLogout\",value:function(){var _tryLogout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this3=this;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Try Logout\");_context3.next=3;return axios({method:'post',url:'http://localhost:3001/logout',data:{}}).then(function(r){_this3.setState({isAuthenticated:false});_this3.setState({current_user:{}});});case 3:case\"end\":return _context3.stop();}}},_callee3);}));function tryLogout(){return _tryLogout.apply(this,arguments);}return tryLogout;}()},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(Mainpage,{}),/*#__PURE__*/_jsx(Bestsellers,{}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(Navbar,{toggleLoginCallback:this.handleToggleLoginCallback,toggleRegisterCallback:this.handleToggleRegisterCallback,handleLogoutCallback:this.handleLogoutCallback,isAuthenticated:this.props.isAuthenticated,current_user:this.props.current_user}),this.props.toggleLogin&&/*#__PURE__*/_jsx(Login,{loginCallback:this.handleLogin}),this.props.toggleRegister&&/*#__PURE__*/_jsx(Register,{registerCallback:this.handleToggleLoginCallback})]});}}]);return Home;}(Component);export default Home;","map":{"version":3,"sources":["C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/src/Components/home.jsx"],"names":["React","Component","axios","Navbar","Login","Register","Bestsellers","Mainpage","Footer","Home","props","handleToggleLoginCallback","setState","toggleLogin","toggleRegister","handleToggleRegisterCallback","handleLogin","tryIsAuthenticated","then","handleLogoutCallback","console","log","tryLogout","isAuthenticated","current_user","handleLoad","bind","window","addEventListener","get","response","data","firstName","catch","error","method","url","r"],"mappings":"2tCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,C,2FAGMC,CAAAA,I,4FACF,cAAYC,KAAZ,CAAmB,sCACf,uBAAMA,KAAN,EADe,MAqBnBC,yBArBmB,CAqBS,UAAM,CAC9B,MAAKC,QAAL,CAAc,CAACC,WAAW,CAAE,CAAC,MAAKH,KAAL,CAAWG,WAA1B,CAAuCC,cAAc,CAAE,KAAvD,CAAd,EACH,CAvBkB,OAwBnBC,4BAxBmB,CAwBY,UAAM,CACjC,MAAKH,QAAL,CAAc,CAACC,WAAW,CAAE,KAAd,CAAqBC,cAAc,CAAE,CAAC,MAAKJ,KAAL,CAAWI,cAAjD,CAAd,EACH,CA1BkB,OA2BnBE,WA3BmB,CA2BL,UAAM,CAChB,MAAKC,kBAAL,GAA0BC,IAA1B,GACH,CA7BkB,OA8BnBC,oBA9BmB,CA8BI,UAAM,CACzBC,OAAO,CAACC,GAAR,CAAY,qBAAZ,EACA,MAAKC,SAAL,GAAiBJ,IAAjB,GACH,CAjCkB,CAEf,MAAKR,KAAL,CAAa,CACTG,WAAW,CAAE,KADJ,CAETC,cAAc,CAAE,KAFP,CAGTS,eAAe,CAAE,KAHR,CAITC,YAAY,CAAE,EAJL,CAAb,CAOA,MAAKC,UAAL,CAAkB,MAAKA,UAAL,CAAgBC,IAAhB,+BAAlB,CATe,aAUlB,C,kDAID,4BAAoB,CAChBC,MAAM,CAACC,gBAAP,CAAwB,MAAxB,CAAgC,KAAKH,UAArC,EACH,C,6GACD,mIACI,KAAKR,kBAAL,GAA0BC,IAA1B,GADJ,2D,qNAkBA,+KACUhB,CAAAA,KAAK,CAAC2B,GAAN,CAAU,iDAAV,EACDX,IADC,CACI,SAAAY,QAAQ,CAAI,CACd,MAAI,CAAClB,QAAL,CAAc,CAACW,eAAe,CAAE,IAAlB,CAAd,EACA,MAAI,CAACX,QAAL,CAAc,CAACY,YAAY,CAAEM,QAAQ,CAACC,IAAxB,CAAd,EACA,MAAI,CAACnB,QAAL,CAAc,CAACC,WAAW,CAAE,KAAd,CAAd,EACAO,OAAO,CAACC,GAAR,CAAY,MAAI,CAACX,KAAL,CAAWc,YAAX,CAAwBQ,SAApC,EACH,CANC,EAMCC,KAND,CAMO,SAAAC,KAAK,CAAI,CACd,MAAI,CAACtB,QAAL,CAAc,CAACW,eAAe,CAAE,KAAlB,CAAd,EACA,MAAI,CAACX,QAAL,CAAc,CAACY,YAAY,CAAE,EAAf,CAAd,EACAJ,OAAO,CAACC,GAAR,CAAY,wBAAZ,CAAsCa,KAAK,CAACH,IAA5C,EACH,CAVC,CADV,yD,2NAcA,wJACIX,OAAO,CAACC,GAAR,CAAY,YAAZ,EADJ,uBAEUnB,CAAAA,KAAK,CAAC,CACRiC,MAAM,CAAE,MADA,CAERC,GAAG,CAAE,8BAFG,CAGRL,IAAI,CAAE,EAHE,CAAD,CAAL,CAIHb,IAJG,CAIE,SAAAmB,CAAC,CAAI,CACT,MAAI,CAACzB,QAAL,CAAc,CAACW,eAAe,CAAE,KAAlB,CAAd,EACA,MAAI,CAACX,QAAL,CAAc,CAACY,YAAY,CAAE,EAAf,CAAd,EACH,CAPK,CAFV,yD,2GAYA,iBAAS,CACL,mBACI,MAAC,KAAD,CAAO,QAAP,yBACI,KAAC,QAAD,IADJ,cAEI,KAAC,WAAD,IAFJ,cAGI,KAAC,MAAD,IAHJ,cAII,KAAC,MAAD,EACI,mBAAmB,CAAI,KAAKb,yBADhC,CAEI,sBAAsB,CAAI,KAAKI,4BAFnC,CAGI,oBAAoB,CAAI,KAAKI,oBAHjC,CAII,eAAe,CAAI,KAAKT,KAAL,CAAWa,eAJlC,CAKI,YAAY,CAAI,KAAKb,KAAL,CAAWc,YAL/B,EAJJ,CAWK,KAAKd,KAAL,CAAWG,WAAX,eAA0B,KAAC,KAAD,EAAO,aAAa,CAAI,KAAKG,WAA7B,EAX/B,CAYK,KAAKN,KAAL,CAAWI,cAAX,eAA6B,KAAC,QAAD,EAAU,gBAAgB,CAAI,KAAKH,yBAAnC,EAZlC,GADJ,CAgBH,C,kBA/EcV,S,EAiFnB,cAAeQ,CAAAA,IAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport Navbar from \"./navbar\";\r\nimport Login from \"./login\";\r\nimport Register from \"./register\";\r\nimport Bestsellers from \"./bestsellers\";\r\nimport Mainpage from \"./mainpage\";\r\nimport Footer from \"./footer\";\r\n\r\n\r\nclass Home extends Component{\r\n    constructor(props) {\r\n        super(props);\r\n        this.props = {\r\n            toggleLogin: false,\r\n            toggleRegister: false,\r\n            isAuthenticated: false,\r\n            current_user: {},\r\n        }\r\n\r\n        this.handleLoad = this.handleLoad.bind(this);\r\n    }\r\n\r\n\r\n\r\n    componentDidMount() {\r\n        window.addEventListener('load', this.handleLoad);\r\n    }\r\n    async handleLoad() {\r\n        this.tryIsAuthenticated().then()\r\n    }\r\nz\r\n    handleToggleLoginCallback = () => {\r\n        this.setState({toggleLogin: !this.props.toggleLogin, toggleRegister: false});\r\n    }\r\n    handleToggleRegisterCallback = () => {\r\n        this.setState({toggleLogin: false, toggleRegister: !this.props.toggleRegister});\r\n    }\r\n    handleLogin = () => {\r\n        this.tryIsAuthenticated().then()\r\n    }\r\n    handleLogoutCallback = () => {\r\n        console.log(\"HandleLogout i home\")\r\n        this.tryLogout().then()\r\n    }\r\n\r\n    async tryIsAuthenticated() {\r\n        await axios.get('http://localhost:3001/api/users/isAuthenticated')\r\n            .then(response => {\r\n                this.setState({isAuthenticated: true});\r\n                this.setState({current_user: response.data})\r\n                this.setState({toggleLogin: false});\r\n                console.log(this.props.current_user.firstName)\r\n            }).catch(error => {\r\n                this.setState({isAuthenticated: false});\r\n                this.setState({current_user: {}})\r\n                console.log(\"No session available: \", error.data);\r\n            })\r\n    }\r\n\r\n    async tryLogout() {\r\n        console.log(\"Try Logout\")\r\n        await axios({\r\n            method: 'post',\r\n            url: 'http://localhost:3001/logout',\r\n            data: {}\r\n        }).then(r => {\r\n            this.setState({isAuthenticated: false});\r\n            this.setState({current_user: {}})\r\n        })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <React.Fragment>\r\n                <Mainpage />\r\n                <Bestsellers />\r\n                <Footer />\r\n                <Navbar\r\n                    toggleLoginCallback = {this.handleToggleLoginCallback}\r\n                    toggleRegisterCallback = {this.handleToggleRegisterCallback}\r\n                    handleLogoutCallback = {this.handleLogoutCallback}\r\n                    isAuthenticated = {this.props.isAuthenticated}\r\n                    current_user = {this.props.current_user}\r\n                />\r\n                {this.props.toggleLogin && <Login loginCallback = {this.handleLogin}/>}\r\n                {this.props.toggleRegister && <Register registerCallback = {this.handleToggleLoginCallback}/>}\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}