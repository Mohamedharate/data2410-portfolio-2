{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import bootbox from\"bootbox\";import FormData from\"form-data\";import DangerFeedback from\"../Feedback/DangerFeedback\";import SuccessFeedback from\"../Feedback/SuccessFeedback\";import LoadingSpinnerPrimaryLongBtn from\"../Spinners/LoadingSpinnerPrimaryLongBtn\";import DeleteForever from\"@material-ui/icons/DeleteForever\";import EditIcon from'@material-ui/icons/Edit';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AdminEditEmployee=/*#__PURE__*/function(_Component){_inherits(AdminEditEmployee,_Component);var _super=_createSuper(AdminEditEmployee);function AdminEditEmployee(props){var _this;_classCallCheck(this,AdminEditEmployee);_this=_super.call(this,props);_this.state={employees:[],employee_id:'',password:String,old_firstName:String,old_lastName:String,old_email:String,old_phoneNumber:String,old_position:String,new_firstName:String,new_lastName:String,new_email:String,new_phoneNumber:String,new_position:String,toggle_submit_loading:false,toggle_get_employee_loading:false,feedback_text:String,toggle_error_feedback:false,toggle_success_feedback:false};_this.handleInputChange=function(event){var target=event.target;var value=target.value;var name=target.name;_this.setState(_defineProperty({},'new_'+name,value));};_this.handleEditBtn=function(employee){_this.setState({employee_id:employee.employeeId,old_firstName:employee.firstName,old_lastName:employee.lastName,old_email:employee.email,old_phoneNumber:employee.phoneNumber,old_position:employee.position,new_firstName:employee.firstName,new_lastName:employee.lastName,new_email:employee.email,new_phoneNumber:employee.phoneNumber,new_position:employee.position});};_this.handleDeleteBtn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(employee){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// Confirm delete\nbootbox.confirm({message:\"Delete \"+employee.firstName+\" \"+employee.lastName+\" from products?\",buttons:{'cancel':{label:'Cancel',className:'btn-default pull-left'},'confirm':{label:'Delete',className:'btn-danger pull-right'}},callback:function(){var _callback=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(result){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!result){_context.next=4;break;}console.log(\"Delete\",employee.firstName);_context.next=4;return axios.delete(\"https://localhost:3001/api/admin/delete/one/\".concat(employee.employeeId))//\n.//\nthen(function(){_this.handleGetEmployees();}).catch(function(err){console.log(err);});case 4:case\"end\":return _context.stop();}}},_callee);}));function callback(_x2){return _callback.apply(this,arguments);}return callback;}()});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var employeeId,change,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();employeeId=_this.state.employee_id;change=false;data={};// Checks which variables has changed and add changed variables to the form-data.\nif(_this.state.old_firstName!==_this.state.new_firstName){change=true;data['firstName']=_this.state.new_firstName;}if(_this.state.old_lastName!==_this.state.new_lastName){change=true;data['lastName']=_this.state.new_lastName;}if(_this.state.old_email!==_this.state.new_email){change=true;data['email']=_this.state.new_email;}if(_this.state.old_phoneNumber!==_this.state.new_phoneNumber){change=true;data['phoneNumber']=_this.state.new_phoneNumber;}if(_this.state.old_position!==_this.state.new_position){change=true;data['position']=_this.state.new_position;}if(!change){_context3.next=13;break;}_this.setState({toggle_submit_loading:true});_context3.next=13;return axios({method:'put',url:\"https://localhost:3001/api/admin/update/\".concat(employeeId),data:data}).then(function(res){_this.setState({toggle_success_feedback:true,toggle_error_feedback:false,feedback_text:res.data.Message,toggle_submit_loading:false});}).catch(function(err){_this.setState({toggle_success_feedback:false,toggle_error_feedback:true,feedback_text:err.response.data.Error,toggle_submit_loading:false});});case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref2.apply(this,arguments);};}();_this.handleGetEmployees=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.setState({toggle_get_employee_loading:true});_context4.next=3;return axios.get('https://localhost:3001/api/admin/get/all').then(function(res){var employees=res.data.Message;_this.setState({employees:employees});}).catch(function(err){_this.setState({toggle_success_feedback:false,toggle_error_feedback:true,feedback_text:err.data.Error});});case 3:_this.setState({toggle_get_employee_loading:false});case 4:case\"end\":return _context4.stop();}}},_callee4);}));_this.handleInputChange=_this.handleInputChange.bind(_assertThisInitialized(_this));return _this;}_createClass(AdminEditEmployee,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"fillPage\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row text-center m-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Edit Employees\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:this.state.toggle_get_employee_loading?/*#__PURE__*/_jsx(LoadingSpinnerPrimaryLongBtn,{}):/*#__PURE__*/_jsx(\"button\",{onClick:this.handleGetEmployees,className:\"btn btn-primary btn-block\",children:\"Get employees\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row text-center mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-4 float-left one\",children:this.state.employees.map(function(employee,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mt-2 ml-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",value:employee.position+\" \\n\"+employee.firstName+\" \"+employee.lastName,rows:\"2\",disabled:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group-append\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this2.handleEditBtn(employee);},className:\"btn btn-outline-secondary\",children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this2.handleDeleteBtn(employee);},className:\"btn btn-danger\",children:/*#__PURE__*/_jsx(DeleteForever,{})})]})]},index);})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8 text-left position-fixed offset-sm-3 mr-2 two\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,className:\"form-signin\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row form-label-group justify-content-center m-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-sm-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\" mt-2\",htmlFor:\"firstName\",children:\"First name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Firstname\",value:this.state.new_firstName,pattern:\"^[A-Z\\xC6\\xD8\\xC5]+[a-z\\xE6\\xF8\\xE5 ,.'-]{1,20}(\\\\s[A-Z\\xC6\\xD8\\xC5]+[a-z\\xE6\\xF8\\xE5 ,.'-]{1,20})?$\",title:\"First name has to start with an upper case letter and have at least 2 characters.\",name:\"firstName\",required:true,autoFocus:\"\"}),/*#__PURE__*/_jsx(\"label\",{className:\" mt-2\",htmlFor:\"lastName\",children:\"Last name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Lastname\",value:this.state.new_lastName,pattern:\"^[A-Z\\xC6\\xD8\\xC5]+[a-z\\xE6\\xF8\\xE5 ,.'-]{1,20}$\",title:\"Last name has to start with an upper case letter and have at least 2 characters.\",name:\"lastName\",required:true,autoFocus:\"\"}),/*#__PURE__*/_jsx(\"label\",{className:\" mt-2\",htmlFor:\"email\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Email\",value:this.state.new_email,name:\"email\",required:true,autoFocus:\"\"}),/*#__PURE__*/_jsx(\"label\",{className:\" mt-2\",htmlFor:\"phoneNumber\",children:\"Phone number:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:this.handleInputChange,className:\"form-control\",placeholder:\"Phone\",value:this.state.new_phoneNumber,pattern:\"^(\\\\+|00)?[1-9][0-9 \\\\-\\\\(\\\\)\\\\.]{7,}$\",title:\"The address should follow this format:\\r <Country code(optional)> <Number(At least 7 digits>.\",name:\"phoneNumber\",required:true,autoFocus:\"\"}),/*#__PURE__*/_jsx(\"label\",{className:\" mt-2\",htmlFor:\"position\",children:\"Title:\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"position\",onChange:this.handleInputChange,value:this.state.new_position,className:\"custom-select my-1 mr-sm-2\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",defaultValue:\"\",children:\"Choose...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"CO-worker\",children:\"CO-worker\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Marketing Coordinator\",children:\"Marketing Coordinator\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Web Designer\",children:\"Web Designer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Project Manager\",children:\"Project Manager\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Executive Sales Manager\",children:\"Executive Sales Manager\"}),/*#__PURE__*/_jsx(\"option\",{value:\"President\",children:\"President\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center m-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-3\",children:this.state.toggle_submit_loading?/*#__PURE__*/_jsx(LoadingSpinnerPrimaryLongBtn,{}):/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block mt-2\",children:\"Update Employee\"})})}),this.state.toggle_error_feedback&&/*#__PURE__*/_jsx(DangerFeedback,{feedback_error_text:this.state.feedback_text}),this.state.toggle_success_feedback&&/*#__PURE__*/_jsx(SuccessFeedback,{feedback_success_text:this.state.feedback_text})]})})]})]});}}]);return AdminEditEmployee;}(Component);export default AdminEditEmployee;","map":{"version":3,"sources":["C:/Users/Gjesterom/IdeaProjects/data2410-portfolio-2/client/src/Components/Admin/AdminEditEmployee.jsx"],"names":["React","Component","axios","bootbox","FormData","DangerFeedback","SuccessFeedback","LoadingSpinnerPrimaryLongBtn","DeleteForever","EditIcon","AdminEditEmployee","props","state","employees","employee_id","password","String","old_firstName","old_lastName","old_email","old_phoneNumber","old_position","new_firstName","new_lastName","new_email","new_phoneNumber","new_position","toggle_submit_loading","toggle_get_employee_loading","feedback_text","toggle_error_feedback","toggle_success_feedback","handleInputChange","event","target","value","name","setState","handleEditBtn","employee","employeeId","firstName","lastName","email","phoneNumber","position","handleDeleteBtn","confirm","message","buttons","label","className","callback","result","console","log","delete","then","handleGetEmployees","catch","err","handleSubmit","preventDefault","change","data","method","url","res","Message","response","Error","get","bind","map","index"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport axios from \"axios\";\r\nimport bootbox from \"bootbox\"\r\nimport FormData from \"form-data\";\r\nimport DangerFeedback from \"../Feedback/DangerFeedback\";\r\nimport SuccessFeedback from \"../Feedback/SuccessFeedback\";\r\nimport LoadingSpinnerPrimaryLongBtn from \"../Spinners/LoadingSpinnerPrimaryLongBtn\";\r\nimport DeleteForever from \"@material-ui/icons/DeleteForever\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\n\r\nclass AdminEditEmployee extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.handleInputChange = this.handleInputChange.bind(this)\r\n    }\r\n\r\n    state = {\r\n        employees: [],\r\n        employee_id: '',\r\n        password: String,\r\n\r\n        old_firstName: String,\r\n        old_lastName: String,\r\n        old_email: String,\r\n        old_phoneNumber: String,\r\n        old_position: String,\r\n\r\n        new_firstName: String,\r\n        new_lastName: String,\r\n        new_email: String,\r\n        new_phoneNumber: String,\r\n        new_position: String,\r\n\r\n        toggle_submit_loading: false,\r\n        toggle_get_employee_loading: false,\r\n        feedback_text: String,\r\n        toggle_error_feedback: false,\r\n        toggle_success_feedback: false,\r\n    };\r\n\r\n    handleInputChange = event => {\r\n        const target = event.target;\r\n        const value = target.value;\r\n        const name = target.name;\r\n\r\n        this.setState({\r\n            ['new_' + name]: value\r\n        })\r\n    };\r\n\r\n    handleEditBtn = employee => {\r\n        this.setState({\r\n            employee_id: employee.employeeId,\r\n\r\n            old_firstName: employee.firstName,\r\n            old_lastName: employee.lastName,\r\n            old_email: employee.email,\r\n            old_phoneNumber: employee.phoneNumber,\r\n            old_position: employee.position,\r\n\r\n            new_firstName: employee.firstName,\r\n            new_lastName: employee.lastName,\r\n            new_email: employee.email,\r\n            new_phoneNumber: employee.phoneNumber,\r\n            new_position: employee.position,\r\n        })\r\n\r\n    }\r\n    handleDeleteBtn = async employee => {\r\n        // Confirm delete\r\n        bootbox.confirm({\r\n            message: \"Delete \" + employee.firstName + \" \" + employee.lastName + \" from products?\",\r\n            buttons: {\r\n                'cancel': {\r\n                    label: 'Cancel',\r\n                    className: 'btn-default pull-left'\r\n                },\r\n                'confirm': {\r\n                    label: 'Delete',\r\n                    className: 'btn-danger pull-right'\r\n                }\r\n            },\r\n            callback: async result => {\r\n                if (result) {\r\n                    console.log(\"Delete\", employee.firstName)\r\n                    await axios.delete(`https://localhost:3001/api/admin/delete/one/${employee.employeeId}`) //\r\n                        .then(() => {\r\n                            this.handleGetEmployees()\r\n                        }).catch(err => {\r\n                            console.log(err)\r\n                        })\r\n                }\r\n            }\r\n        });\r\n    }\r\n    handleSubmit = async event => {\r\n        event.preventDefault();\r\n        const employeeId = this.state.employee_id\r\n\r\n        let change = false;\r\n        let data = {}\r\n\r\n        // Checks which variables has changed and add changed variables to the form-data.\r\n        if (this.state.old_firstName !== this.state.new_firstName) {\r\n            change = true;\r\n            data['firstName'] = this.state.new_firstName;\r\n        }\r\n        if (this.state.old_lastName !== this.state.new_lastName) {\r\n            change = true;\r\n            data['lastName'] = this.state.new_lastName;\r\n        }\r\n        if (this.state.old_email !== this.state.new_email) {\r\n            change = true;\r\n            data['email'] = this.state.new_email;\r\n        }\r\n        if (this.state.old_phoneNumber !== this.state.new_phoneNumber) {\r\n            change = true;\r\n            data['phoneNumber'] = this.state.new_phoneNumber;\r\n        }\r\n        if (this.state.old_position !== this.state.new_position) {\r\n            change = true;\r\n            data['position'] = this.state.new_position;\r\n        }\r\n\r\n        if(change){\r\n            this.setState({toggle_submit_loading: true});\r\n            await axios({\r\n                method: 'put',\r\n                url: `https://localhost:3001/api/admin/update/${employeeId}`,\r\n                data: data,\r\n            }).then(res => {\r\n                this.setState({\r\n                    toggle_success_feedback: true,\r\n                    toggle_error_feedback: false,\r\n                    feedback_text: res.data.Message,\r\n                    toggle_submit_loading: false\r\n                });\r\n            }).catch(err => {\r\n                this.setState({\r\n                    toggle_success_feedback: false,\r\n                    toggle_error_feedback: true,\r\n                    feedback_text: err.response.data.Error,\r\n                    toggle_submit_loading: false\r\n                });\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    handleGetEmployees = async () => {\r\n        this.setState({toggle_get_employee_loading: true});\r\n        await axios.get('https://localhost:3001/api/admin/get/all')\r\n            .then(res => {\r\n                const employees = res.data.Message;\r\n                this.setState({employees})\r\n            }).catch(err => {\r\n                this.setState({\r\n                    toggle_success_feedback: false,\r\n                    toggle_error_feedback: true,\r\n                    feedback_text: err.data.Error,\r\n                });\r\n            });\r\n        this.setState({toggle_get_employee_loading: false});\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"fillPage\">\r\n                <div className=\"row text-center m-5\">\r\n                    <div className=\"col-md-4\"/>\r\n                    <div className=\"col-md-4\">\r\n                        <h3>Edit Employees</h3>\r\n                    </div>\r\n                    <div className=\"col-md-4\">\r\n                        {this.state.toggle_get_employee_loading ? <LoadingSpinnerPrimaryLongBtn/> :\r\n                            <button onClick={this.handleGetEmployees} className=\"btn btn-primary btn-block\">\r\n                                Get employees\r\n                            </button>}\r\n                    </div>\r\n                </div>\r\n                <div className=\"row text-center mt-5\">\r\n                    <div className=\"col-sm-4 float-left one\">\r\n                        {this.state.employees.map((employee, index) => (\r\n                            <div className=\"input-group mt-2 ml-2\" key={index}>\r\n                                <textarea type=\"text\"\r\n                                       value={employee.position + \" \\n\" + employee.firstName + \" \" + employee.lastName}\r\n                                       rows=\"2\" disabled/>\r\n                                <div className=\"input-group-append\">\r\n                                    <button onClick={() => this.handleEditBtn(employee)} className=\"btn btn-outline-secondary\">\r\n                                        <EditIcon/>\r\n                                    </button>\r\n                                    <button onClick={() => this.handleDeleteBtn(employee)} className=\"btn btn-danger\">\r\n                                        <DeleteForever/>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"col-sm-8 text-left position-fixed offset-sm-3 mr-2 two\">\r\n                        <form onSubmit={this.handleSubmit} className=\"form-signin\">\r\n                            <div className=\"row form-label-group justify-content-center m-2\">\r\n                                <div className=\"col-sm-6\">\r\n                                    <label className=\" mt-2\" htmlFor=\"firstName\">First name:</label>\r\n                                    <input type=\"text\" onChange={this.handleInputChange}\r\n                                           className=\"form-control\" placeholder=\"Firstname\"\r\n                                           value={this.state.new_firstName}\r\n                                           pattern=\"^[A-ZÆØÅ]+[a-zæøå ,.'-]{1,20}(\\s[A-ZÆØÅ]+[a-zæøå ,.'-]{1,20})?$\"\r\n                                           title=\"First name has to start with an upper case letter and have at least 2 characters.\"\r\n                                           name=\"firstName\" required autoFocus=\"\"/>\r\n                                    <label className=\" mt-2\" htmlFor=\"lastName\">Last name:</label>\r\n                                    <input type=\"text\" onChange={this.handleInputChange}\r\n                                           className=\"form-control\" placeholder=\"Lastname\"\r\n                                           value={this.state.new_lastName}\r\n                                           pattern=\"^[A-ZÆØÅ]+[a-zæøå ,.'-]{1,20}$\"\r\n                                           title=\"Last name has to start with an upper case letter and have at least 2 characters.\"\r\n                                           name=\"lastName\" required autoFocus=\"\"/>\r\n                                    <label className=\" mt-2\" htmlFor=\"email\">Email:</label>\r\n                                    <input type=\"email\" onChange={this.handleInputChange}\r\n                                           className=\"form-control\" placeholder=\"Email\"\r\n                                           value={this.state.new_email}\r\n                                           name=\"email\" required autoFocus=\"\"/>\r\n                                    <label className=\" mt-2\" htmlFor=\"phoneNumber\">Phone number:</label>\r\n                                    <input type=\"text\" onChange={this.handleInputChange}\r\n                                           className=\"form-control\" placeholder=\"Phone\"\r\n                                           value={this.state.new_phoneNumber}\r\n                                           pattern=\"^(\\+|00)?[1-9][0-9 \\-\\(\\)\\.]{7,}$\"\r\n                                           title=\"The address should follow this format:\r\n                                       <Country code(optional)> <Number(At least 7 digits>.\"\r\n                                           name=\"phoneNumber\" required autoFocus=\"\"/>\r\n                                    <label className=\" mt-2\" htmlFor=\"position\">Title:</label>\r\n                                    <select name=\"position\" onChange={this.handleInputChange}\r\n                                            value={this.state.new_position}\r\n                                            className=\"custom-select my-1 mr-sm-2\" required>\r\n                                        <option value=\"\" defaultValue=\"\">Choose...</option>\r\n                                        <option value=\"CO-worker\">CO-worker</option>\r\n                                        <option value=\"Marketing Coordinator\">Marketing Coordinator</option>\r\n                                        <option value=\"Web Designer\">Web Designer</option>\r\n                                        <option value=\"Project Manager\">Project Manager</option>\r\n                                        <option value=\"Executive Sales Manager\">Executive Sales Manager</option>\r\n                                        <option value=\"President\">President</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"row justify-content-center m-2\">\r\n                                <div className=\"col-md-3\">\r\n                                    {this.state.toggle_submit_loading ? <LoadingSpinnerPrimaryLongBtn/> :\r\n                                        <button type=\"submit\" className=\"btn btn-primary btn-block mt-2\">\r\n                                            Update Employee\r\n                                        </button>}\r\n                                </div>\r\n                            </div>\r\n                            {this.state.toggle_error_feedback &&\r\n                            <DangerFeedback feedback_error_text={this.state.feedback_text}/>}\r\n                            {this.state.toggle_success_feedback &&\r\n                            <SuccessFeedback feedback_success_text={this.state.feedback_text}/>}\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AdminEditEmployee;"]},"metadata":{},"sourceType":"module"}